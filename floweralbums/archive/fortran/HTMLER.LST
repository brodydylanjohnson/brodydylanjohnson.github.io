WATFOR-77 V3.1 Copyright WATCOM Systems Inc. 1984,1989  04/12/24 17:00:33

Options: list,disk,extensions,warnings,edit,exe,xtype,terminal,logio,check,arraycheck

      1       program htmler
        C      parameter (pi = 3.141593)
        C      real pi
*EXT* CC-04 character encountered is not FORTRAN 77 standard
      2       integer i,nalb,npg,nphot,junk,test1,test2
        C      complex c11
      3       character fname*12,pname1*8,pname2*8,an*2,pn*2,cap1*50,
             $          cap2*50,name*12,st*1
        
      4    1  write(*,*) 'Album Number: '
      5       read(*,*) nalb
      6       if ((nalb.lt.0) .or. (nalb.ge.100)) goto 1
        
      7    2  write(*,*) 'Number of Pages: (1<=pages<=99)'
      8       read(*,*) npg
      9       if ((npg.le.0) .or. (npg.ge.100)) goto 2
        
     10       an = char((nalb-mod(nalb,10))/10+48) //
             $     char(mod(nalb,10)+48)
     11       name = 'album' // an // '.txt'
     12       open(5,file=name,status='old')
        
     13       do 51 i=1,npg
     14         pn = char((i-mod(i,10))/10+48) //
             $       char(mod(i,10)+48)
     15         fname = 'alb' // an // pn // '.htm'
     16         nphot = 2*(i-1)+1
     17         pname1 = 'alb' // char((nalb-mod(nalb,10))/10+48) //
             $           char(mod(nalb,10)+48) // 'p' //
             $           char((nphot-mod(nphot,10))/10+48) //
             $           char(mod(nphot,10)+48)
     18         pname2 = 'alb' // char((nalb-mod(nalb,10))/10+48) //
             $           char(mod(nalb,10)+48) // 'p' //
             $           char((nphot+1-mod(nphot+1,10))/10+48) //
             $           char(mod(nphot+1,10)+48)
        
     19         open(4,file=fname,status='new')
        C       write(*,*) name
     20         write(*,*) fname
        
        C  WRITING HTML FILE FOR ONE PAGE (with TWO PHOTOS on it)
     21         write(4,*) '<html>'
     22         write(4,*) '<head>'
     23         write(4,*) '<title>photoalbum</title>'
     24         write(4,*) '<link rel="stylesheet" type="text/css"',
             $             'href="album.css" />'
     25         write(4,*) '<script src="hotchocolate.js"> </script>'
     26         write(4,*) '</head>'
     27         write(4,*) '<body>'     28         write(4,*) '<table class="album">'
     29         write(4,*) '<tr><td class="photo">'
     30         read(5,*) junk
     31         read(5,*) st
     32         if ((ichar(st)-48).gt.1) then
     33           test1=1
     34         else
     35           test1=0
     36         endif
     37         st = char(mod(ichar(st)-48,2)+48)
     38         write(4,*) '<a href="./' // pname1 // '.htm">',
             $             ' <img class="page' // st // '"',
             $             ' src="./' // pname1 // '.jpg" '
     39         write(4,*) 'name="' // pname1 // '"> </a>'
     40         write(4,*) '</td>'
     41         write(4,*) '<td class="photo">'
     42         read(5,*) cap1
     43         read(5,*) junk
     44         read(5,*) st
     45         if ((ichar(st)-48).gt.1) then
     46           test2=1
     47         else
     48           test2=0
     49         endif
     50         st = char(mod(ichar(st)-48,2)+48)
     51         write(4,*) '<a href="./' // pname2 // '.htm">',
             $             ' <img class="page' // st // '"',
             $             ' src="./' // pname2 // '.jpg" '
     52         write(4,*) 'name="' // pname2 // '"> </a>'
     53         write(4,*) '</td></tr>'
     54         write(4,*) '<tr><td class="caption">'
     55         if (test1 .eq. 1) then
     56           write(4,*) '<div id="beej" onMouseOver="back(''' // pname1 //
             $               ''')" onMouseOut="front(''' // pname1 //
             $               ''')">'
     57         else
     58           write(4,*) '<div id="beej" >'
     59         endif
     60         write(4,*) cap1
     61         write(4,*) '</div>'
     62         write(4,*) '</td>'
     63         write(4,*) '<td class="caption">'
     64         read(5,*) cap2
     65         if (test2 .eq. 1) then
     66           write(4,*) '<div id="beej" onMouseOver="back(''' // pname2 //
             $               ''')" onMouseOut="front(''' // pname2 //
             $               ''')">'
     67         else
     68           write(4,*) '<div id="beej" >'
     69         endif
     70         write(4,*) cap2
     71         write(4,*) '</div>'
     72         write(4,*) '</td></tr>'
     73         write(4,*) '</table>'     74         write(4,*) '<br>'
     75         write(4,*) '<table class="nav">'
     76         write(4,*) '<tr><td class="left">'
     77         if (i.eq.1) then
     78           write(4,*) '<a class="bj" href="./index.html">',
             $               ' <h1> Cover </h1> </a>'
     79         else
     80           pn = char((i-1-mod(i-1,10))/10+48) //
             $         char(mod(i-1,10)+48)
     81           write(4,*) '<a class="bj" href="./alb' // an //
             $               pn // '.htm">',
             $               ' <h1> Previous Page </h1> </a>'
     82         endif
     83         write(4,*) '</td>'
     84         write(4,*) '<td class="right">'
     85         if (i.eq.npg) then
     86           write(4,*) '<a class="bj" href="./index.html">',
             $               ' <h1> Cover </h1> </a>'
     87         else
     88           pn = char((i+1-mod(i+1,10))/10+48) //
             $         char(mod(i+1,10)+48)
     89           write(4,*) '<a class="bj" href="./alb' // an //
             $               pn // '.htm">',
             $               ' <h1> Next Page </h1> </a>'
     90         endif
     91         write(4,*) '</td></tr>'
     92         write(4,*) '</table>'
     93         write(4,*) '</body>'
     94         write(4,*) '</html>'
     95         close(4)
        
        C  WRITE FIRST PHOTO SOLO PAGE
     96         fname=pname1 // '.htm'
     97         open(4,file=fname,status='new')
     98         write(4,*) '<html>'
     99         write(4,*) '<head>'
    100         write(4,*) '<title>photo album</title>'
    101         write(4,*) '<link rel="stylesheet" type="text/css"',
             $             'href="album.css" media="all" />'
    102         write(4,*) '<link rel="stylesheet" type="text/css"',
             $             'href="print.css" media="print" />'
    103         write(4,*) '<script src="hotchocolate.js"> </script>'
    104         write(4,*) '</head>'
    105         write(4,*) '<body>'
    106         write(4,*) '<img class="solo" src="./' // pname1 // '.jpg"',
             $             ' name="' // pname1 // '">'
    107         write(4,*) '<br>'
    108         if (test1 .eq. 1) then
    109           write(4,*) '<div id="bee" onMouseOver="back(''' // pname1 //
             $               ''')" onMouseOut="front(''' // pname1 //
             $               ''')" '
    110           write(4,*) 'onclick="tog()"> '
    111         else
    112           write(4,*) '<div id="bee" >'    113         endif
    114         write(4,*) cap1
    115         write(4,*) '</div>'
    116         write(4,*) '</body>'
    117         write(4,*) '</html>'
    118         close(4)
        
        C  WRITE SECOND PHOTO SOLO PAGE
    119         fname=pname2 // '.htm'
    120         open(4,file=fname,status='new')
    121         write(4,*) '<html>'
    122         write(4,*) '<head>'
    123         write(4,*) '<title>photo album</title>'
    124         write(4,*) '<link rel="stylesheet" type="text/css"',
             $             'href="album.css" media="all" />'
    125         write(4,*) '<link rel="stylesheet" type="text/css"',
             $             'href="print.css" media="print" />'
    126         write(4,*) '<script src="hotchocolate.js"> </script>'
    127         write(4,*) '</head>'
    128         write(4,*) '<body>'
    129         write(4,*) '<img class="solo" src="./' // pname2 // '.jpg"',
             $             ' name="' // pname2 // '">'
    130         write(4,*) '<br>'
    131         if (test2 .eq. 1) then
    132           write(4,*) '<div id="bee" onMouseOver="back(''' // pname2 //
             $               ''')" onMouseOut="front(''' // pname2 //
             $               ''')" '
    133           write(4,*) 'onclick="tog()" >'
    134         else
    135           write(4,*) '<div id="bee" >'
    136         endif
    137         write(4,*) cap2
    138         write(4,*) '</div>'
    139         write(4,*) '</body>'
    140         write(4,*) '</html>'
    141         close(4)
    142  51   continue
    143       close(5)
        
    144       end


Compile time:                      00.06  Execution time:              00.00
Size of object code:                4682  Number of extensions:            1
Size of local data area(s):         2392  Number of warnings:              0
Size of global data area:            145  Number of errors:                0
Object/Dynamic bytes free:  343568/46246  Statements Executed:             0
